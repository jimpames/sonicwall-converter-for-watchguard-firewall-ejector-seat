# WatchGuard Configuration
# Generated by FIREWALL EJECTOR SEAT v1.3.6
# N2NHU Labs / MTOR Foundation
# Converted from SonicWall on 2025-10-12 19:55:44
# Original config had 21159 lines

# ============================================================================
# SECURITY ZONES
# ============================================================================

# SonicWall Zone: LAN
# Security Type: trusted
# WatchGuard Mapping: trusted zone
# Confidence: 95%
# Security Services: Gateway AV, IPS, Anti-Spyware, App Control
# Interfaces in this zone should be assigned 'security-zone trusted'

# SonicWall Zone: WAN
# Security Type: untrusted
# WatchGuard Mapping: external zone
# Confidence: 95%
# Security Services: Gateway AV, IPS, Anti-Spyware, App Control
# Interfaces in this zone should be assigned 'security-zone external'

# SonicWall Zone: DMZ
# Security Type: public
# WatchGuard Mapping: optional zone
# Confidence: 90%
# Interfaces in this zone should be assigned 'security-zone optional'

# SonicWall Zone: VPN
# Security Type: encrypted
# WatchGuard Mapping: vpn zone
# Confidence: 85%
# Interfaces in this zone should be assigned 'security-zone vpn'

# SonicWall Zone: SSLVPN
# Security Type: sslvpn
# WatchGuard Mapping: optional zone
# Confidence: 100%
# Interfaces in this zone should be assigned 'security-zone optional'

# SonicWall Zone: MULTICAST
# Security Type: untrusted
# WatchGuard Mapping: external zone
# Confidence: 95%
# Interfaces in this zone should be assigned 'security-zone external'

# SonicWall Zone: WLAN
# Security Type: wireless
# WatchGuard Mapping: trusted zone
# Confidence: 85%
# Interfaces in this zone should be assigned 'security-zone trusted'

# ============================================================================
# INTERFACES
# ============================================================================

# SonicWall Interface: X0
# IP Assignment: LAN static
# IP Address: 10.12.20.177/24
#
# WatchGuard Interface: 0
# WatchGuard Zone: trusted
#
configure
  interface 0
    enable
    security-zone trusted
    ip address 10.12.20.177/24
    mtu 1500
    link-speed auto-negotiate
  exit

# SonicWall Interface: X1
# IP Assignment: WAN static
# IP Address: 141.10.150.12/24
#
# WatchGuard Interface: 1
# WatchGuard Zone: external
#
configure
  interface 1
    enable
    security-zone external
    ip address 141.10.150.12/24
    mtu 1500
    link-speed auto-negotiate
  exit

# SonicWall Interface: X2
# IP Assignment: disabled
#
# WatchGuard Interface: 2
# WatchGuard Zone: trusted
#
configure
  interface 2
    enable
    security-zone trusted
    mtu 1500
    link-speed auto-negotiate
  exit

# SonicWall Interface: X3
# IP Assignment: LAN static
# IP Address: 192.168.10.1/24
#
# WatchGuard Interface: 3
# WatchGuard Zone: trusted
#
configure
  interface 3
    enable
    security-zone trusted
    ip address 192.168.10.1/24
    mtu 1500
    link-speed auto-negotiate
  exit

# SonicWall Interface: X4
# IP Assignment: LAN portshield X0
#
# WatchGuard Interface: 4
# WatchGuard Zone: trusted
#
configure
  interface 4
    enable
    security-zone trusted
    mtu 1500
    link-speed auto-negotiate
  exit

# ============================================================================
# VPN POLICIES - v1.3.6 FINAL POLISH FOR PRODUCTION
# ============================================================================

# SonicWall VPN: WAN GroupVPN
# Type: MOBILE VPN
# Status: DISABLED
#
# Mobile VPN Configuration
#
# IKE Phase 1: 3DES/SHA1/Diffie-Hellman-Group2
# IPSec Phase 2: 3DES/SHA1
#
mvpn-ikev2
  no enable
  pre-shared-secret 4,72d7ff8731c77de0ad1931bb265ff2150a10480a1448aad97a3677448629c38269c91743e642e532ab58d55d87bdb85b94a1e3bf10079a61eddff564d2a4c914367b7f27582d373e919b9dd90971e80784fce51fb01e13e971c8415d948350598b9c481616301603cf46aa3e4652c8e9e55cb98ee6d0bdac58100166f9f19f8601ff35401a2b8b42
  phase1 transform SHA1 3DES 8 unit hour Diffie-Hellman-Group2
  phase2 proposal p2-WAN-GroupVPN
  apply
exit

proposal p2 p2-WAN-GroupVPN esp transform 1 unit minute 3des SHA1

# Client Settings from SonicWall:
#   client-cache-xauth: never
#   client-virtual-adaptor: none
#   client-allow-connections-to: split-tunnels
#   client default-route: False
#   client simple-provisioning: False
#   client-authentication: require-xauth "Trusted Users"
# Client Authentication: require-xauth "Trusted Users"

# SonicWall VPN: WLAN GroupVPN
# Type: MOBILE VPN
# Status: DISABLED
#
# Mobile VPN Configuration
#
# IKE Phase 1: 3DES/SHA1/Diffie-Hellman-Group2
# IPSec Phase 2: 3DES/SHA1
#
mvpn-ikev2
  no enable
  pre-shared-secret 4,01ff35401a2b8b4292b331bfcf51e478e2909598dbcdc9486dd2383a22c94d1d659ce9248bb27ea4ea7912ab02582b5aeea682a5397bf5d2ace46949a5b3d2affbad95cf5b85b6fdb4082aad444412af2f121f21079b08415c481c50374844e29343aa57bc694c5f308aa3e30933fa28f9c7059f0f008d12e2408e975ddfd47638ab88c9d644ca62
  phase1 transform SHA1 3DES 8 unit hour Diffie-Hellman-Group2
  phase2 proposal p2-WLAN-GroupVPN
  apply
exit

proposal p2 p2-WLAN-GroupVPN esp transform 1 unit minute 3des SHA1

# Client Settings from SonicWall:
#   client-cache-xauth: single-session
#   client-virtual-adaptor: none
#   client-allow-connections-to: all-secured-gateways
#   client-default-route: disable-acl
#   client-simple-provisioning: True
#   client-authentication: require-xauth "Trusted Users"
# Client Authentication: require-xauth "Trusted Users"

# ============================================================================
# FIREWALL POLICIES
# ============================================================================

# SonicWall Access Rule #1
# From: LAN → To: WAN
# Action: allow
#
policy
  name Policy-001-LAN-to-WAN
  from alias Trusted
  to alias External
  service Any
  firewall allow
  exit

# SonicWall Access Rule #2
# From: LAN → To: DMZ
# Action: allow
#
policy
  name Policy-002-LAN-to-DMZ
  from alias Trusted
  to alias Optional
  service Any
  firewall allow
  exit

# SonicWall Access Rule #3
# From: LAN → To: WLAN
# Action: allow
#
policy
  name Policy-003-LAN-to-WLAN
  from alias Trusted
  to alias Trusted
  service Any
  firewall allow
  exit

# SonicWall Access Rule #4
# From: WAN → To: LAN
# Action: deny
#
policy
  name Policy-004-WAN-to-LAN
  from alias External
  to alias Trusted
  service Any
  firewall deny
  exit

# SonicWall Access Rule #5
# From: WAN → To: DMZ
# Action: deny
#
policy
  name Policy-005-WAN-to-DMZ
  from alias External
  to alias Optional
  service Any
  firewall deny
  exit

# SonicWall Access Rule #6
# From: WAN → To: WLAN
# Action: deny
#
policy
  name Policy-006-WAN-to-WLAN
  from alias External
  to alias Trusted
  service Any
  firewall deny
  exit

# SonicWall Access Rule #7
# From: DMZ → To: LAN
# Action: deny
#
policy
  name Policy-007-DMZ-to-LAN
  from alias Optional
  to alias Trusted
  service Any
  firewall deny
  exit

# SonicWall Access Rule #8
# From: DMZ → To: WAN
# Action: allow
#
policy
  name Policy-008-DMZ-to-WAN
  from alias Optional
  to alias External
  service Any
  firewall allow
  exit

# SonicWall Access Rule #9
# From: DMZ → To: WLAN
# Action: deny
#
policy
  name Policy-009-DMZ-to-WLAN
  from alias Optional
  to alias Trusted
  service Any
  firewall deny
  exit

# SonicWall Access Rule #10
# From: WLAN → To: LAN
# Action: deny
#
policy
  name Policy-010-WLAN-to-LAN
  from alias Trusted
  to alias Trusted
  service Any
  firewall deny
  exit

# SonicWall Access Rule #11
# From: WLAN → To: WAN
# Action: allow
#
policy
  name Policy-011-WLAN-to-WAN
  from alias Trusted
  to alias External
  service Any
  firewall allow
  exit

# SonicWall Access Rule #12
# From: WLAN → To: DMZ
# Action: allow
#
policy
  name Policy-012-WLAN-to-DMZ
  from alias Trusted
  to alias Optional
  service Any
  firewall allow
  exit

